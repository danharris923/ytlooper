chrome.action.onClicked.addListener(async e=>{if(e.id&&e.url&&!e.url.startsWith("chrome://")&&!e.url.startsWith("moz-extension://"))try{await chrome.tabs.sendMessage(e.id,{action:"showGUI"})}catch(t){console.warn("Could not send message to content script:",t);try{await chrome.scripting.executeScript({target:{tabId:e.id},files:["content.js"]}),setTimeout(async()=>{try{await chrome.tabs.sendMessage(e.id,{action:"showGUI"})}catch(t){console.warn("Failed to show GUI after script injection:",t)}},500)}catch(o){console.warn("Failed to inject content script:",o)}}}),chrome.runtime.onInstalled.addListener(e=>{"install"===e.reason?console.log("YT Looper extension installed"):"update"===e.reason&&console.log("YT Looper extension updated to version:",chrome.runtime.getManifest().version)});
